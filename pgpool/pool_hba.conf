# pool_hba.conf - Host-based authentication for pgpool-II
# TYPE  DATABASE    USER        CIDR-ADDRESS          METHOD

# Local connections
local   all         all                               trust
host    all         all         127.0.0.1/32          scram-sha-256
host    all         all         ::1/128               scram-sha-256

# Docker network
host    all         all         172.0.0.0/8           scram-sha-256

# Allow all from internal network
# Restrict wide-open access in Docker: prefer your Docker subnet. Adjust if your network differs.
# Original (wide open): host    all         all         0.0.0.0/0             scram-sha-256
host    all         all         172.18.0.0/16         scram-sha-256
# Allow any IPv6 by default in this template. Adjust if you want to restrict IPv6 ranges.
host    all         all         ::/0                 scram-sha-256
host    all         all         0.0.0.0/0                 scram-sha-256

# "local" is for Unix domain socket connections only
local   all             all                                     trust
# IPv4 local connections:
host    all             all             127.0.0.1/32            trust
host    all             all             ::1/128                 trust
# Allow replication connections from localhost, by a user with the
# replication privilege.
local   replication     all                                     trust
host    replication     all             127.0.0.1/32            trust
host    replication     all             ::1/128                 trust

# === PCP Connections ===
# Allow PCP connections from localhost for the 'repmgr' user without a password.
# This is secure because it only applies to connections from within the container.
local   pcp             repmgr                                  trust
host    pcp             repmgr          127.0.0.1/32            trust
host    pcp             repmgr          ::1/128                 trust

# === PCP Connections ===
# Allow PCP connections from localhost without password
local   pcp             repmgr                                  trust
host    pcp             repmgr          127.0.0.1/32            trust